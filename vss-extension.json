{
  "manifestVersion": 1,
  "id": "qualys-security-scanner",
  "name": "Qualys Security Scanner",
  "version": "1.0.0",
  "publisher": "your-publisher-id",
  "public": false,
  "targets": [
    {
      "id": "Microsoft.VisualStudio.Services"
    }
  ],
  "description": "Integrate Qualys Container Security and SCA scanning into your Azure Pipelines",
  "categories": ["Azure Pipelines"],
  "tags": [
    "security",
    "container",
    "sca",
    "vulnerability",
    "qualys",
    "devsecops",
    "docker",
    "sbom"
  ],
  "icons": {
    "default": "images/extension-icon.png"
  },
  "content": {
    "details": {
      "path": "overview.md"
    }
  },
  "repository": {
    "type": "git",
    "uri": "https://github.com/your-org/qualys-ado"
  },
  "branding": {
    "color": "#1a1a2e",
    "theme": "dark"
  },
  "files": [
    {
      "path": "src/tasks/QualysContainerScan",
      "packagePath": "QualysContainerScan"
    },
    {
      "path": "src/tasks/QualysSCAScan",
      "packagePath": "QualysSCAScan"
    },
    {
      "path": "images",
      "addressable": true
    }
  ],
  "contributions": [
    {
      "id": "qualys-endpoint",
      "description": "Service connection for Qualys API",
      "type": "ms.vss-endpoint.service-endpoint-type",
      "targets": ["ms.vss-endpoint.endpoint-types"],
      "properties": {
        "name": "QualysApiConnection",
        "displayName": "Qualys API Connection",
        "url": {
          "displayName": "API Server URL",
          "description": "Qualys API Gateway URL (e.g., https://gateway.qg4.apps.qualys.ca for Canada)",
          "value": "https://gateway.qg4.apps.qualys.ca",
          "helpText": "Enter the Qualys API gateway URL for your platform"
        },
        "authenticationSchemes": [
          {
            "type": "ms.vss-endpoint.endpoint-auth-scheme-token",
            "displayName": "Access Token",
            "inputDescriptors": [
              {
                "id": "accessToken",
                "name": "Access Token",
                "description": "Qualys Access Token from Container Security > Configuration > Access Token",
                "inputMode": "passwordbox",
                "isConfidential": true,
                "validation": {
                  "isRequired": true,
                  "dataType": "string"
                }
              },
              {
                "id": "pod",
                "name": "Pod",
                "description": "Qualys platform pod identifier",
                "inputMode": "combo",
                "isConfidential": false,
                "validation": {
                  "isRequired": true,
                  "dataType": "string"
                },
                "values": {
                  "inputId": "podValues",
                  "defaultValue": "CA1",
                  "possibleValues": [
                    { "value": "US1", "displayValue": "US1 (US Platform 1)" },
                    { "value": "US2", "displayValue": "US2 (US Platform 2)" },
                    { "value": "US3", "displayValue": "US3 (US Platform 3)" },
                    { "value": "US4", "displayValue": "US4 (US Platform 4)" },
                    { "value": "EU1", "displayValue": "EU1 (Europe 1)" },
                    { "value": "EU2", "displayValue": "EU2 (Europe 2)" },
                    { "value": "CA1", "displayValue": "CA1 (Canada)" },
                    { "value": "IN1", "displayValue": "IN1 (India)" },
                    { "value": "AU1", "displayValue": "AU1 (Australia)" },
                    { "value": "UK1", "displayValue": "UK1 (United Kingdom)" },
                    { "value": "AE1", "displayValue": "AE1 (UAE)" },
                    { "value": "KSA1", "displayValue": "KSA1 (Saudi Arabia)" }
                  ]
                }
              }
            ]
          },
          {
            "type": "ms.vss-endpoint.endpoint-auth-scheme-basic",
            "displayName": "Username/Password",
            "inputDescriptors": [
              {
                "id": "username",
                "name": "Username",
                "description": "Qualys platform username",
                "inputMode": "textbox",
                "isConfidential": false,
                "validation": {
                  "isRequired": true,
                  "dataType": "string"
                }
              },
              {
                "id": "password",
                "name": "Password",
                "description": "Qualys platform password",
                "inputMode": "passwordbox",
                "isConfidential": true,
                "validation": {
                  "isRequired": true,
                  "dataType": "string"
                }
              },
              {
                "id": "pod",
                "name": "Pod",
                "description": "Qualys platform pod identifier",
                "inputMode": "combo",
                "isConfidential": false,
                "validation": {
                  "isRequired": true,
                  "dataType": "string"
                },
                "values": {
                  "inputId": "podValues",
                  "defaultValue": "CA1",
                  "possibleValues": [
                    { "value": "US1", "displayValue": "US1 (US Platform 1)" },
                    { "value": "US2", "displayValue": "US2 (US Platform 2)" },
                    { "value": "US3", "displayValue": "US3 (US Platform 3)" },
                    { "value": "US4", "displayValue": "US4 (US Platform 4)" },
                    { "value": "EU1", "displayValue": "EU1 (Europe 1)" },
                    { "value": "EU2", "displayValue": "EU2 (Europe 2)" },
                    { "value": "CA1", "displayValue": "CA1 (Canada)" },
                    { "value": "IN1", "displayValue": "IN1 (India)" },
                    { "value": "AU1", "displayValue": "AU1 (Australia)" },
                    { "value": "UK1", "displayValue": "UK1 (United Kingdom)" },
                    { "value": "AE1", "displayValue": "AE1 (UAE)" },
                    { "value": "KSA1", "displayValue": "KSA1 (Saudi Arabia)" }
                  ]
                }
              }
            ]
          }
        ],
        "helpMarkDown": "Create a connection to the Qualys platform. [Learn more](https://docs.qualys.com)"
      }
    },
    {
      "id": "qualys-container-scan-task",
      "type": "ms.vss-distributed-task.task",
      "targets": ["ms.vss-distributed-task.tasks"],
      "properties": {
        "name": "QualysContainerScan"
      }
    },
    {
      "id": "qualys-sca-scan-task",
      "type": "ms.vss-distributed-task.task",
      "targets": ["ms.vss-distributed-task.tasks"],
      "properties": {
        "name": "QualysSCAScan"
      }
    }
  ]
}
